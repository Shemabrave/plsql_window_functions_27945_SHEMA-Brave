CREATE TABLE regions (
    region_id NUMBER NOT NULL,
    region_name VARCHAR2(100) NOT NULL,

    CONSTRAINT pk_regions PRIMARY KEY (region_id)
);
INSERT INTO regions VALUES (1, 'North');
INSERT INTO regions VALUES (2, 'South');
INSERT INTO regions VALUES (3, 'East');
INSERT INTO regions VALUES (4, 'West');

CREATE TABLE properties (
    property_id NUMBER NOT NULL,
    property_name VARCHAR2(150) NOT NULL,
    property_type VARCHAR2(50),
    region_id NUMBER NOT NULL,
    listing_price NUMBER(12,2),

    CONSTRAINT pk_properties PRIMARY KEY (property_id),
    CONSTRAINT fk_properties_regions
        FOREIGN KEY (region_id)
        REFERENCES regions(region_id)
);
INSERT INTO properties VALUES
(101, 'Green Valley Apartments', 'Residential', 1, 120000);

INSERT INTO properties VALUES
(102, 'Sunset Villas', 'Residential', 2, 180000);

INSERT INTO properties VALUES
(103, 'Downtown Office Plaza', 'Commercial', 3, 350000);

INSERT INTO properties VALUES
(104, 'Lakeside Mall', 'Commercial', 4, 500000);

INSERT INTO properties VALUES
(105, 'Hilltop Residences', 'Residential', 1, 150000);

CREATE TABLE sales (
    sale_id NUMBER NOT NULL,
    property_id NUMBER NOT NULL,
    client_name VARCHAR2(100),
    sale_date DATE,
    sale_amount NUMBER(12,2),

    CONSTRAINT pk_sales PRIMARY KEY (sale_id),
    CONSTRAINT fk_sales_properties
        FOREIGN KEY (property_id)
        REFERENCES properties(property_id)
);
INSERT INTO sales VALUES
(1001, 101, 'Alice Johnson', DATE '2024-01-15', 118000);

INSERT INTO sales VALUES
(1002, 102, 'Brian Smith', DATE '2024-02-10', 175000);

INSERT INTO sales VALUES
(1003, 103, 'Charles Brown', DATE '2024-03-05', 340000);

INSERT INTO sales VALUES
(1004, 101, 'Diana Miller', DATE '2024-03-20', 119500);

INSERT INTO sales VALUES
(1005, 105, 'Ethan Wilson', DATE '2024-04-12', 148000);
SELECT 
    s.sale_id,
    s.sale_date,
    s.sale_amount,
    s.client_name,
    p.property_name,
    p.property_type,
    r.region_name
FROM sales s
INNER JOIN properties p ON s.property_id = p.property_id
INNER JOIN regions r ON p.region_id = r.region_id;

SELECT 
    c.client_name,
    s.sale_id
FROM clients c
LEFT JOIN sales s ON c.client_name = s.client_name
WHERE s.sale_id IS

SELECT 
    p.property_name,
    p.property_type,
    s.sale_id,
    s.sale_date
FROM sales s
RIGHT JOIN properties p ON s.property_id = p.property_id
WHERE s.sale_id IS NULL;

SELECT 
    c.client_name,
    p.property_name,
    s.sale_id
FROM clients c
FULL OUTER JOIN sales s ON c.client_name = s.client_name
FULL OUTER JOIN properties p ON s.property_id = p.property_id;

SELECT 
    p1.property_name AS property_1,
    p2.property_name AS property_2,
    r.region_name
FROM properties p1
INNER JOIN properties p2 ON p1.region_id = p2.region_id
    AND p1.property_id < p2.property_id
INNER JOIN regions r ON p1.region_id = r.region_id;


